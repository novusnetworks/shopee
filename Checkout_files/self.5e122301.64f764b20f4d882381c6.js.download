(window.miniJsonp=window.miniJsonp||[]).push([[15],{"1UzO":function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MdapSdk=e.CustomPlugin=e.host=e.BasePlugin=void 0;var s=n("x/NT"),u=n("UQ8Y"),c=n("alxF");Object.defineProperty(e,"BasePlugin",{enumerable:!0,get:function(){return a(c).default}});var l=n("Oe/c"),p=n("5CVp"),h=n("JoM6"),f=a(n("IbGn")),d=n("JoM6");Object.defineProperty(e,"host",{enumerable:!0,get:function(){return d.host}});var g=n("nqH1");Object.defineProperty(e,"CustomPlugin",{enumerable:!0,get:function(){return a(g).default}});var v=function(){function t(t){this.inited=!1,this.enable=!1,this.remoteConfigMap={},this.localConfigUnexpired=!1;try{this.configs=t,this.network=new u.Network({env:t.environment,app_name:t.app_name,secret_key:t.secret_key,report_host:t.report_host}),this.reporter=new s.Reporter(t,this.network),l.Logger.mute=!t.logger,this.storage=new p.MdapStorage({name:h.CONFIT_STORAGE_PREFIX}),this.initConfig(),t.async_config||this.localConfigUnexpired||this.updateLocalConfig()}catch(t){l.Logger.log("Failed to init mdap sdk"),l.Logger.error(t)}}return t.prototype.setConfig=function(t){void 0===t&&(t={}),this.configs=Object.assign(this.configs,t),this.reporter.updateConfig(this.configs),this.localConfigUnexpired||this.updateLocalConfig()},Object.defineProperty(t.prototype,"localConfigStorageKey",{get:function(){var t=this.configs,e=t.app_version;return t.app_name+"_"+(null!=e?e:"unknown")},enumerable:!1,configurable:!0}),t.prototype.getLocalConfig=function(){var t,e,n,r,o,i=this.storage.getObject(this.localConfigStorageKey);if(null==i?void 0:i.config){var a=i.config,s=!("DISABLED"===(null===(t=i.sdk_spec)||void 0===t?void 0:t.status))&&((null==a?void 0:a.vip_user)||(null===(n=null===(e=null==a?void 0:a.switch_config_extra)||void 0===e?void 0:e.switch_config)||void 0===n?void 0:n.is_sampled)),u=(null===(r=i.sdk_spec)||void 0===r?void 0:r.config_max_age)?1e3*(null===(o=i.sdk_spec)||void 0===o?void 0:o.config_max_age):18e5;return this.localConfigUnexpired=i.last_update&&i.last_update+u>+new Date,{enable:s,config:i}}return{enable:!1}},t.prototype.initPluginConfigs=function(){var t,e,n=null===(t=this.localConfig)||void 0===t?void 0:t.config;if(null===(e=null==n?void 0:n.switch_config)||void 0===e?void 0:e.switch_config)try{for(var r=n.switch_config.switch_config,o=(r.app_sample,i(r,["app_sample"])),a=0,s=Object.keys(o);a<s.length;a++){var u=s[a],c=o[u],p={};"regexp"===c.filter_type&&(p.path=c.filter_value.map((function(t){return new RegExp(t)}))),"string"===c.filter_type&&(p.path=c.filter_value),this.remoteConfigMap[u]=p}}catch(t){l.Logger.log("Failed to init remote configs")}},t.prototype.initConfig=function(){var t;try{var e=this.getLocalConfig();this.enable=e.enable,this.localConfig=e.config,this.enable&&(this.initPluginConfigs(),null===(t=this.reporter)||void 0===t||t.start()),this.inited=!0}catch(t){l.Logger.log("Failed to init config")}},Object.defineProperty(t.prototype,"defaultSample",{get:function(){return"number"==typeof this.configs.sample&&this.configs.sample>=0&&this.configs.sample<=1?this.configs.sample:.1},enumerable:!1,configurable:!0}),t.prototype.resetLocalConfig=function(){try{this.storage.removeItem(this.localConfigStorageKey)}catch(t){}},t.prototype.updateLocalConfig=function(){var t,e,n,i,a,s,u;return r(this,void 0,void 0,(function(){var r,c,p,h,d,g;return o(this,(function(o){switch(o.label){case 0:r=this.localConfig,o.label=1;case 1:return o.trys.push([1,5,,6]),this.reporter.fingerprint?[3,3]:[4,this.reporter.initFingerprint()];case 2:o.sent(),o.label=3;case 3:return c=null===(e=null===(t=null==r?void 0:r.config)||void 0===t?void 0:t.switch_config_checksum)||void 0===e?void 0:e.switch_config,p=null===(a=null===(i=null===(n=null==r?void 0:r.config)||void 0===n?void 0:n.switch_config_extra)||void 0===i?void 0:i.switch_config)||void 0===a?void 0:a.is_sampled,h="-1"===c&&this.defaultSample!==(null==r?void 0:r.default_sample),[4,this.network.fetchRemoteConfigs({tags:["web-performance"],view:"ALL",user_id:this.configs.user_id,sdk_name:f.default.name,sdk_version:f.default.version,os_name:this.reporter.userAgent.device.os_name,os_version:this.reporter.userAgent.device.os_version,device_name:this.reporter.userAgent.device.device_name,device_id:this.reporter.fingerprint,switch_config_labels:{app_version:this.configs.app_version},sdk_spec_checksum:null==r?void 0:r.sdk_spec_checksum,switch_config_keys:[{key:"switch_config",checksum:h?"":c,sample_sub_key:"app_sample",default_sample_rate:this.defaultSample,is_sampled:p}]})];case 4:return d=o.sent(),c&&(null===(u=null===(s=d.config)||void 0===s?void 0:s.switch_config_checksum)||void 0===u?void 0:u.switch_config)===c&&(d.config.switch_config=r.config.switch_config),d.default_sample=this.defaultSample,d.last_update=+new Date,this.storage.setObject(this.localConfigStorageKey,d),[3,6];case 5:return g=o.sent(),this.resetLocalConfig(),l.Logger.log("[MDAP] Failed to init configs"),l.Logger.error(g),[3,6];case 6:return[2]}}))}))},t.prototype.use=function(t){var e;this.inited&&this.enable&&(this.remoteConfigMap[t.type]&&t.updateConfig(this.remoteConfigMap[t.type]),null===(e=this.reporter)||void 0===e||e.register(t))},t.prototype.remove=function(t){var e;null===(e=this.reporter)||void 0===e||e.unregister(t)},t}();e.MdapSdk=v},"5CVp":function(t,e,n){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.MdapStorage=e.supportLocalstorage=void 0,e.supportLocalstorage="function"==typeof(null===(r=window.localStorage)||void 0===r?void 0:r.getItem)&&"function"==typeof window.localStorage.setItem;var o=function(){function t(t){this.prefix="mdap",this.prefix=t.name}return t.prototype.getStorageKey=function(t){if(e.supportLocalstorage){var n=t;return new RegExp("^"+this.prefix).test(t)||(n=this.prefix+"_"+t),n}},t.prototype.setObject=function(t,n){if(e.supportLocalstorage)try{var r="string"==typeof n?n:JSON.stringify(n),o=this.getStorageKey(t);localStorage.setItem(o,r)}catch(t){}},t.prototype.getObject=function(t){if(e.supportLocalstorage)try{var n=this.getStorageKey(t),r=localStorage.getItem(n);if(!r)return;return JSON.parse(r)}catch(t){}},t.prototype.getKeys=function(){if(e.supportLocalstorage){for(var t=[],n=localStorage.length,r=new RegExp("^"+this.prefix),o=0;o<n;o++){var i=localStorage.key(o);r.test(i)&&t.push(i)}return t}},t.prototype.removeItem=function(t){if(e.supportLocalstorage){var n=this.getStorageKey(t);localStorage.removeItem(n)}},t.prototype.clear=function(){if(e.supportLocalstorage)for(var t=0,n=this.getKeys();t<n.length;t++){var r=n[t];localStorage.removeItem(r)}},t}();e.MdapStorage=o},"69Pc":function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.UserAgent=void 0;var i=o(n("K4CH")),a=n("hgXC"),s=n("5CVp"),u=function(){function t(){this.browserCompatibility={supportFetch:a.APIs.supportFetch?"true":"false",supportFetchKeepAlive:a.APIs.supportFetchKeepAlive?"true":"false",supportSendBeacon:a.APIs.sendBeacon?"true":"false",supportLocalstorage:s.supportLocalstorage?"true":"false"};var t=new i.default;this.ua=t.getResult()}return Object.defineProperty(t.prototype,"connection",{get:function(){var t,e,n,r;return navigator.connection?{connection_type:(null===(t=navigator.connection)||void 0===t?void 0:t.effectiveType)||(null===(e=navigator.connection)||void 0===e?void 0:e.type),connection_downlink:1024*(null===(n=navigator.connection)||void 0===n?void 0:n.downlink),connection_rtt:null===(r=navigator.connection)||void 0===r?void 0:r.rtt}:{connection_type:"unknown"}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"browser",{get:function(){return{browser:this.ua.ua,browser_name:this.ua.browser.name,browser_version:this.ua.browser.version,engine_name:this.ua.engine.name,engine_version:this.ua.engine.version}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{get:function(){return{screen_dpr:window.devicePixelRatio?parseFloat(window.devicePixelRatio.toFixed(2)):void 0,screen_height:window.screen.height,screen_width:window.screen.width}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"device",{get:function(){var t,e,n;return{os_name:this.ua.os.name,os_version:this.ua.os.version,device_name:null!==(e=null===(t=this.ua.device)||void 0===t?void 0:t.model)&&void 0!==e?e:null===(n=this.ua.device)||void 0===n?void 0:n.type,device_id:""}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"webData",{get:function(){return r(r(r({},this.browser),this.screen),this.connection)},enumerable:!1,configurable:!0}),t}();e.UserAgent=u},"9GJY":function(t,e,n){"use strict";var r,o,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.CacheType=void 0;var s,u=n("1UzO"),c=n("Oe/c"),l=n("G4lm"),p=function(t){var e,n;return null===(n=null===(e=window.PerformanceObserver)||void 0===e?void 0:e.supportedEntryTypes)||void 0===n?void 0:n.includes(t)},h="function"==typeof(null===(o=window.performance)||void 0===o?void 0:o.getEntriesByType);!function(t){t.UNKNOWN="unknown",t.SERVICE_WORKER="service_worker",t.CACHE="cache",t.NOT_MODIFIED="not_modified",t.NETWORK="network"}(s=e.CacheType||(e.CacheType={}));var f=["script","link","img"],d={script:"script",link:"css",img:"image"},g={script:"js",css:"css",image:/jpg|jpeg|png|svg|gif|ico/,json:"json"},v=function(t,e){if(f.includes(e)){var n=d[e];if(n)return n}for(var r=function(t){var e;return null===(e=t.match(/\.(\w{2,5})$/))||void 0===e?void 0:e[1]}(t),o=0,i=Object.keys(g);o<i.length;o++){var a=i[o],s=g[a];if(null==r?void 0:r.match(s))return a}},y=200,_=400,m=1e4,b=function(t){function e(e){var n=t.call(this,e)||this;return n.type="resource",n.supportObserver=!0,n.configs=e,n}return i(e,t),e.prototype.register=function(t){this.triggerHandler=t.trigger,this.projectId=t.app_name,e.TRIGGER_MAPS[t.app_name]={match:this.isMatch.bind(this),triggerFunciton:t.trigger},this.init()},e.prototype.init=function(){try{if(this.observeError(),this.handleLoadedResource(),"function"==typeof this.addLabels&&this.addLabels({supportObserveType:p("resource")?"true":"false",supportGetEntriesByType:h?"true":"false"}),e.filled)return;this.observe()}catch(t){c.Logger.log("Failed to init mdap resource plugin"),c.Logger.error(t)}},e.prototype.isMatch=function(t){var e;if(!(null===(e=this.configs.path)||void 0===e?void 0:e.length))return!0;for(var n=!1,r=0,o=this.configs.path;r<o.length;r++){var i=o[r];if(t.match(i)){n=!0;break}}return n},e.prototype.processData=function(t,e){var n=performance.timeOrigin||performance.timing.navigationStart,r=function(t){return"decodedBodySize"in t&&"encodedBodySize"in t&&"transferSize"in t?"workerStart"in t&&t.workerStart>0&&0===t.transferSize?s.SERVICE_WORKER:0===t.transferSize?s.CACHE:t.transferSize<t.encodedBodySize||0===t.encodedBodySize?s.NOT_MODIFIED:t.transferSize>t.encodedBodySize&&t.encodedBodySize>0?s.NETWORK:s.UNKNOWN:s.UNKNOWN}(t),o=[s.SERVICE_WORKER,s.CACHE,s.NOT_MODIFIED].includes(r)?0:function(t){return"transferSize"in t&&"duration"in t?Math.round(t.transferSize/t.duration/10.24)/100:0}(t),i=""+window.location.origin+window.location.pathname;return{url:t.name,start_timestamp:Math.round(n+t.startTime),end_timestamp:Math.round(n+t.responseEnd),duration:Math.round(t.duration)||Math.round(t.responseEnd-t.startTime),page_url:i,http_method:"GET",logic_status_code:0,http_status_code:y,resource_type:e,resource_cache_type:r,resource_load_speed:o,resource_query_cache:Math.max(Math.round(t.domainLookupStart-t.fetchStart),0),resource_load_time:Math.max(Math.round(t.responseEnd-t.responseStart),0)}},e.prototype.handleEntry=function(t,n){if(void 0===n&&(n="observer"),function(t){return"resource"===t.entryType}(t)){var r=v(t.name,t.initiatorType);if(r)if("init"!==n)for(var o=0,i=Object.values(e.TRIGGER_MAPS);o<i.length;o++){var a=i[o];if(a.match(t.name)){s=this.processData(t,r);a.triggerFunciton(s)}}else if(this.isMatch(t.name)){var s=this.processData(t,r);this.triggerHandler(s)}}},e.prototype.handleLoadedResource=function(){var t=this;h&&performance.getEntriesByType("resource").map((function(e){t.handleEntry(e)}))},e.prototype.observe=function(){var t=this;if(p("resource"))return e.po=new PerformanceObserver((function(e){return e.getEntries().map(t.handleEntry.bind(t))})),void e.po.observe({entryTypes:["resource"]});h?new l.DynamicResourceObserver(this.projectId,(function(e){for(var n=0,r=e;n<r.length;n++){var o=r[n];t.handleEntry(o)}})).observe():this.supportObserver=!1},e.prototype.removeObserve=function(){this.projectId&&delete e.TRIGGER_MAPS[this.projectId]},e.prototype.disconnectObserve=function(){var t;null===(t=e.po)||void 0===t||t.disconnect()},e.prototype.reportErrorData=function(t){if(this.isMatch(t.src)){var e=v(t.src,t.initiatorType),n=performance.timeOrigin||performance.timing.navigationStart,r=Math.round(t.timeStamp+n),o=""+window.location.origin+window.location.pathname;this.triggerHandler({url:t.src,http_method:"GET",start_timestamp:r,end_timestamp:r,duration:1,page_url:o,logic_status_code:0,http_status_code:_,resource_type:e}),this.supportObserver||this.triggerHandler({url:t.src,http_method:"GET",start_timestamp:r,end_timestamp:r,duration:1,page_url:o,logic_status_code:0,http_status_code:m,resource_type:e})}},e.prototype.handleError=function(t){return"link"===t.target.localName?(this.reportErrorData({src:t.target.href,timeStamp:t.timeStamp,initiatorType:t.target.localName}),!0):!!function(t){return f.includes(t.localName)}(t.target)&&(this.reportErrorData({src:t.target.src,timeStamp:t.timeStamp,initiatorType:t.target.localName}),!0)},e.prototype.observeError=function(){var t=this,e=window.__MDAP_PREV_RESOURCE__;if(null==e?void 0:e.data)for(var n=0,r=e.data;n<r.length;n++){var o=r[n];this.handleError(o)}window.addEventListener("error",(function(e){return t.handleError(e),!1}),!0)},e.prototype.sendData=function(t){if("function"==typeof this.triggerHandler)if(t.url)if("number"==typeof t.duration){var e={resource_cache_type:"unknown",http_status_code:200,http_method:"GET",logic_status_code:0,end_timestamp:+new Date,start_timestamp:+new Date-t.duration};t.resource_type||(e.resource_type=v(t.url,"unknown"),e.resource_type)?this.triggerHandler(a(a({},e),t)):c.Logger.info("[MDAP] Unsupported resource type. "+t.url)}else c.Logger.info("[MDAP] Duration should be number.");else c.Logger.info("[MDAP] URL cannot be empty");else c.Logger.log("[MDAP] resource plugin is inactive")},e.TRIGGER_MAPS={},e.filled=!1,e}(u.BasePlugin);e.default=b},G4lm:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DynamicResourceObserver=void 0;var r=function(){function t(e,n){this.timer=null,this.lastCheck=0,t.listenerMap[e]=n}return t.dispatchEvent=function(e){try{for(var n=0,r=Object.values(t.listenerMap);n<r.length;n++){(0,r[n])(e)}}catch(t){}},t.prototype.observe=function(){this.lastCheck=+new Date,t.active||(this.detect(),t.active=!0)},t.prototype.getNewEntries=function(){var e=this;try{var n=performance.timeOrigin||performance.timing.navigationStart,r=performance.getEntriesByType("resource").filter((function(t){return t.startTime+Math.max(t.duration,0)+n>=e.lastCheck}));r.length&&(t.dispatchEvent(r),this.lastCheck=+new Date)}catch(t){}},t.prototype.detect=function(){var e=this;this.timer=setInterval((function(){e.getNewEntries()}),t.interval);var n="onpagehide"in self?"pagehide":"beforeunload";window.addEventListener(n,(function(){e.getNewEntries()}))},t.listenerMap={},t.active=!1,t.interval=1e4,t}();e.DynamicResourceObserver=r},IbGn:function(t){t.exports=JSON.parse('{"name":"mdap_web_sdk","version":"0.4.4"}')},JoM6:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LOCAL_CONFIG_MAX_AGE=e.CONFIT_STORAGE_PREFIX=e.API_ERROR_CODE=e.apiMaps=e.API_PREFIX=e.host=void 0,e.host={live:"https://dem.shopee.com",test:"https://dem.exp.shopee.io",staging:"https://dem.exp.shopee.io",uat:"https://dem.exp.shopee.io",mock:"https://api.seller.shopee.io/mock/1900"},e.API_PREFIX="/dem/entrance/v1/apps",e.apiMaps={login:"/dem/janus/v1/app-auth/login"},e.API_ERROR_CODE={INVALID_ARGUMENT:4e5,INVALID_CONTENT_TYPE:400001,INVALID_FILE:400010,UNAUTHORIZED_TOKEN:401e3,TOKEN_EXPIRED:401001,PERMISSION_DENIED:403e3},e.CONFIT_STORAGE_PREFIX="MDAP_CONFIG_STORAGE",e.LOCAL_CONFIG_MAX_AGE=864e5},"Oe/c":function(t,e,n){"use strict";var r=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t};Object.defineProperty(e,"__esModule",{value:!0}),e.Logger=void 0,e.Logger={mute:!1,log:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.mute||console.log.apply(console,r([t],null!=e?e:[]))},warn:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.mute||console.warn.apply(console,r([t],null!=e?e:[]))},info:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.mute||console.info.apply(console,r([t],null!=e?e:[]))},error:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.mute||console.error.apply(console,r([t],null!=e?e:[]))}}},TLvQ:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.retry=void 0;var i=2;e.retry=function(t,e){void 0===e&&(e={});var n=e.retry_limit,a=void 0===n?i:n,s=0;return function e(){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t()];case 1:return[2,r.sent()];case 2:return n=r.sent(),s>=a?[2,Promise.reject(new Error(n))]:(s+=1,[2,e()]);case 3:return[2]}}))}))}()}},UQ8Y:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Network=e.REQUEST_FAILED=void 0;var s=n("JoM6"),u=n("Oe/c"),c=n("UuF5"),l=n("hgXC");e.REQUEST_FAILED=-999;var p=function(t){function n(e){var n,r=t.call(this,{app_name:e.app_name,secret_key:e.secret_key,host:e.report_host||(null!==(n=s.host[e.env])&&void 0!==n?n:s.host.test),env:e.env})||this;return r.inited=!1,r.fetchToken(),r}return o(n,t),n.prototype.getReportDataUrl=function(t){return""+this.host+s.API_PREFIX+"/"+this.app_name+"/tags/"+t+"/event/json"},n.prototype.getReportDataFileUrl=function(t){return""+this.host+s.API_PREFIX+"/"+this.app_name+"/tags/"+t+"/event/formdata"},n.prototype.getReportBulkUrl=function(t){return""+this.host+s.API_PREFIX+"/"+this.app_name+"/tags/"+t+"/event/json/_bulk"},n.prototype.getRemoteConfigUrl=function(){return this.host+"/dem/kose/v1/apps/"+this.app_name+"/configs/_fetch"},n.prototype.fetchRemoteConfigs=function(t){var e,n;return i(this,void 0,void 0,(function(){var r,o;return a(this,(function(i){switch(i.label){case 0:return[4,this.checkAuth()];case 1:return i.sent(),r=this.getRemoteConfigUrl(),[4,l.APIs.post({url:r,token:this.token,data:t})];case 2:return function(t){var e,n;return null===(n=null===(e=t)||void 0===e?void 0:e.configs)||void 0===n?void 0:n.length}(o=i.sent())?[2,{config:null===(n=null===(e=o.configs)||void 0===e?void 0:e.filter((function(t){return"web-performance"===t.tag})))||void 0===n?void 0:n[0],sdk_spec:o.sdk_spec}]:[2,void 0]}}))}))},n.prototype.sendRequest=function(t){return i(this,void 0,void 0,(function(){var n,r=this;return a(this,(function(o){switch(o.label){case 0:return[4,this.checkAuth()];case 1:return o.sent(),n=function(){return i(r,void 0,void 0,(function(){var n,r,o,i,s,c,p,h,f;return a(this,(function(a){switch(a.label){case 0:return n=t.reportData,r=t.pageUnload,o=void 0!==r&&r,i=n.tag,l.APIs.supportFetchKeepAlive?(s=this.getReportDataUrl(i),[4,l.APIs.fetchPost({url:s,data:n,token:this.token})]):[3,2];case 1:return h=a.sent(),u.Logger.info("[MDAP] post successfully - event_id "+(null==h?void 0:h.event_id)),[2,h];case 2:return o&&l.APIs.supportSendBeacon?(c=this.token?"?access_token="+this.token:"",p=""+this.getReportDataFileUrl(i)+c,(h=l.APIs.sendBeacon({url:p,data:n}))?[2]:[2,e.REQUEST_FAILED]):o?[2,e.REQUEST_FAILED]:(f=this.getReportDataUrl(i),[2,l.APIs.postXHR({url:f,data:n,token:this.token,async:!o})])}}))}))},[2,this.authRetryWrapper(n)]}}))}))},n.prototype.sendBulk=function(t){return i(this,void 0,void 0,(function(){var e,n,r=this;return a(this,(function(o){switch(o.label){case 0:return[4,this.checkAuth()];case 1:return o.sent(),e=this.getReportBulkUrl(t.tag),n=function(){return i(r,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return[4,l.APIs.post({url:e,data:{events:t.data},token:this.token})];case 1:return[2,n.sent()]}}))}))},[2,this.authRetryWrapper(n)]}}))}))},n}(c.Auth);e.Network=p},UuF5:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Auth=void 0;var a=n("JoM6"),s=i(n("H3n2")),u=n("hgXC"),c=n("TLvQ"),l=n("5CVp"),p=function(t){return t&&+new Date<t-6e4},h=function(){function t(t){this.pending=!1,this.pendingTasks=[],this.loginFailed=!1,this.lastLogin=0,this.app_name=t.app_name,this.secret_key=t.secret_key,this.host=t.host,this.storage=new l.MdapStorage({name:"mdap_persisttk_"+this.app_name+"_"+t.env})}return t.prototype.onFulfilled=function(){for(;this.pendingTasks.length;){(0,this.pendingTasks.shift().executor)(!0)}},t.prototype.onRejected=function(){for(;this.pendingTasks.length;){(0,this.pendingTasks.shift().reject)(!1)}},t.prototype.getCachedToken=function(){var t=this.storage.getObject("persisttk");if(!this.token||(null==t?void 0:t.token)!==this.token)return(null==t?void 0:t.maxAge)&&t.lastUpdate&&p(t.lastUpdate+t.maxAge)?(this.tokenExpireAt=t.lastUpdate+t.maxAge,t.token):void 0},t.prototype.cacheToken=function(t){var e=+new Date;this.storage.setObject("persisttk",{lastUpdate:e,token:t.access_token,maxAge:t.max_age?1e3*t.max_age:12e5})},t.prototype.fetchToken=function(){return r(this,void 0,void 0,(function(){var t,e,n,r,i,l,p=this;return o(this,(function(o){switch(o.label){case 0:if(this.pending)return[2];if(t=this.getCachedToken())return this.token=t,this.onFulfilled(),this.loginFailed=!1,[2,{access_token:t}];this.pending=!0,o.label=1;case 1:return o.trys.push([1,3,,4]),e=+new Date,(n=new s.default("SHA-256","TEXT")).update(""+this.app_name+this.secret_key+e),r=n.getHash("HEX"),[4,c.retry((function(){return u.APIs.postXHR({url:""+p.host+a.apiMaps.login,data:{app_name:p.app_name,sign:r,timestamp:e}})}))];case 2:return function(t){var e;return null===(e=t)||void 0===e?void 0:e.access_token}(i=o.sent())?(this.token=i.access_token,this.onFulfilled(),this.pending=!1,this.loginFailed=!1,this.lastLogin=+new Date,l=i.max_age?1e3*i.max_age:12e5,this.tokenExpireAt=l+ +new Date,this.cacheToken(i),[2,i]):[3,4];case 3:return o.sent(),[3,4];case 4:return this.onRejected(),this.pending=!1,this.loginFailed=!0,this.lastLogin=+new Date,[2,!1]}}))}))},t.prototype.checkAuth=function(){return r(this,void 0,void 0,(function(){var t,e,n=this;return o(this,(function(r){return t=p(this.tokenExpireAt),this.pending||this.loginFailed||!t?(e=+new Date-this.lastLogin>6e4,this.loginFailed&&!e?[2,Promise.reject(new Error("login failed"))]:e||!t?[2,this.updateAuth()]:[2,new Promise((function(t,e){n.pendingTasks.push({executor:t,reject:e})}))]):[2,!0]}))}))},t.prototype.updateAuth=function(){return r(this,void 0,void 0,(function(){var t,e=this;return o(this,(function(n){return t=this.token,this.pending||this.fetchToken(),this.token&&t!==this.token?[2,!0]:[2,new Promise((function(t,n){e.pendingTasks.push({executor:t,reject:n})}))]}))}))},t.prototype.authRetryWrapper=function(t){return r(this,void 0,void 0,(function(){var e,n,i=this;return o(this,(function(s){return e=0,[2,(n=function(){return r(i,void 0,void 0,(function(){var r,i;return o(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t()];case 1:return r=o.sent(),[a.API_ERROR_CODE.UNAUTHORIZED_TOKEN,a.API_ERROR_CODE.TOKEN_EXPIRED].includes(null===(i=r)||void 0===i?void 0:i.code)?[3,3]:[2,r];case 2:return[2,o.sent()];case 3:return e>=2?(this.loginFailed=!0,[2]):(e+=1,[4,this.updateAuth()]);case 4:return o.sent(),[2,n()]}}))}))})()]}))}))},t}();e.Auth=h},alxF:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.type="base",this.triggerHandler=function(t){},this.delegateReporter=!1,this.configs=t}return t.prototype.register=function(t){this.triggerHandler=t.trigger},t.prototype.unregister=function(t){this.triggerHandler=function(){}},t.prototype.updateConfig=function(t){this.configs=Object.assign(this.configs,t)},t.prototype.addLabels=function(t){},t}();e.default=r},hgXC:function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=this&&this.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n};Object.defineProperty(e,"__esModule",{value:!0}),e.APIs=void 0,e.APIs={supportFetch:"function"==typeof window.fetch,supportFetchKeepAlive:window.fetch&&"keepalive"in new Request(""),supportSendBeacon:null===navigator||void 0===navigator?void 0:navigator.sendBeacon,get:function(t){return o(this,void 0,void 0,(function(){return i(this,(function(e){return[2,new Promise((function(e,n){var r=new XMLHttpRequest;r.open("GET",t),r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE)return 200===r.status?e(r.response):n(r.response)},r.send()}))]}))}))},post:function(t){var e=t.url,n=t.data,o=t.token;return this.supportFetch?fetch(e,{method:"POST",headers:r({"Content-Type":"application/json",Accept:"application/json"},o?{Authorization:"Bearer "+o}:{}),body:JSON.stringify(n)}).then((function(t){return t.json()})):this.postXHR(t)},sendBeacon:function(t){if(this.supportSendBeacon){for(var e=t.url,n=t.data,r=new FormData,o=n.data,i=a(n,["data"]),s=0,u=Object.keys(i);s<u.length;s++){var c=u[s],l=i[c];r.append(c,null!=l?l:"unknown")}return r.append("data",JSON.stringify(o)),navigator.sendBeacon(e,r)}return!1},fetchPost:function(t){var e=t.url,n=t.data,o=t.token;return!!this.supportFetchKeepAlive&&fetch(e,{method:"POST",headers:r({"Content-Type":"application/json",Accept:"application/json"},o?{Authorization:"Bearer "+o}:{}),keepalive:!0,body:JSON.stringify(n)}).then((function(t){return t.json()}))},postXHR:function(t){var e=t.url,n=t.data,r=t.async,o=void 0===r||r,i=t.token;return new Promise((function(t,r){var a=new XMLHttpRequest;a.open("POST",e,o),a.setRequestHeader("Content-Type","application/json"),i&&a.setRequestHeader("Authorization","Bearer "+i),a.addEventListener("readystatechange",(function(){if(a.readyState===XMLHttpRequest.DONE){if(200===a.status){var e=a.response;try{e=JSON.parse(e)}catch(t){}return t(e)}return r(a.response)}})),a.send(JSON.stringify(n))}))}}},mywx:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.uuidv4=void 0,e.uuidv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))}},nqH1:function(t,e,n){"use strict";var r,o=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},a=this&&this.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var u=s(n("alxF")),c=n("Oe/c"),l=function(t){if(!t)return{};for(var e={},n=0,r=Object.keys(t);n<r.length;n++){var o=r[n],i=t[o];e[o]=i?"string"!=typeof i?i.toString():i:""}return e},p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="customized",e}return o(e,t),e.prototype.sendData=function(t){if(t.point_id)if(function(t){return void 0!==t.duration}(t))this.triggerHandler({type:"customized",customized_point_id:t.point_id,duration:Math.round(t.duration),customized_data:l(t.data)});else{var e=t.data,n=a(t,["data"]);this.triggerHandler(i(i({},n),{type:"custom_accum",timestamp:+new Date,data:l(e)}))}else c.Logger.warn("[MDAP] Custom Report - point Id is required.")},e}(u.default);e.default=p},nxCq:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.OfflineStore=void 0;var i=n("5CVp"),a=n("Oe/c"),s=function(t){var e;return"web-performance"===(null===(e=t)||void 0===e?void 0:e.tag)},u=function(t){var e;return"web-custom"===(null===(e=t)||void 0===e?void 0:e.tag)},c=function(t){var e;return"web-exception"===(null===(e=t)||void 0===e?void 0:e.tag)},l=function(t){var e;return"web-exception"===(null===(e=null==t?void 0:t[0])||void 0===e?void 0:e.tag)},p=function(){function t(t,e){this.pending=!1;try{this.storage=new i.MdapStorage({name:"mdap_offlinestore_"+t}),this.network=e}catch(t){}}return t.prototype.setup=function(){var t=this;i.supportLocalstorage&&(this.checkCache(),window.addEventListener("online",(function(){t.checkCache()})))},t.prototype.checkCache=function(){return r(this,void 0,void 0,(function(){var t,e,n,r,a,p,h,f;return o(this,(function(o){switch(o.label){case 0:if(o.trys.push([0,7,,8]),this.pending&&!i.supportLocalstorage)return[2];for(this.pending=!0,t=this.storage.getKeys(),e=[],n=[],r=[],a=0,p=t;a<p.length;a++)h=p[a],f=this.storage.getObject(h),s(f)?e.push(f):u(f)?n.push(f):c(f)?r.push(f):l(f)&&r.push.apply(r,f),this.storage.removeItem(h);return e.length?[4,this.network.sendBulk({tag:"web-performance",data:e})]:[3,2];case 1:o.sent(),o.label=2;case 2:return n.length?[4,this.network.sendBulk({tag:"web-custom",data:n})]:[3,4];case 3:o.sent(),o.label=4;case 4:return r.length?[4,this.network.sendBulk({tag:"web-exception",data:r})]:[3,6];case 5:o.sent(),o.label=6;case 6:return[3,8];case 7:return o.sent(),[3,8];case 8:return this.pending=!1,[2]}}))}))},t.prototype.checkLimit=function(){var t=this.storage.getKeys();if(t.length<30)return!0;for(var e=0,n=t.sort((function(t,e){return t>e?-1:1})).slice(29,t.length);e<n.length;e++){var r=n[e];this.storage.removeItem(r)}},t.prototype.cacheData=function(t){return r(this,void 0,void 0,(function(){var e;return o(this,(function(n){if(!i.supportLocalstorage)return[2];try{this.checkLimit(),e="data_"+ +new Date,this.storage.setObject(e,t)}catch(t){a.Logger.log("[MDAP] Failed to cache data.")}return[2]}))}))},t}();e.OfflineStore=p},v1wG:function(t,e,n){"use strict";var r,o,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=this&&this.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n};Object.defineProperty(e,"__esModule",{value:!0});var u=n("1UzO"),c=n("Oe/c"),l="function"==typeof(null===(o=window.performance)||void 0===o?void 0:o.getEntriesByType),p=["duration","connectEnd","connectStart","responseStart","responseEnd","requestStart"],h=function(t){var e=t.replace(/(\?\w+?=.*$)/,"");return/^http/.test(t)||(e=window.location.origin+e),e},f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="api",e.originalDatas={},e.host="",e}return i(e,t),e.prototype.isMatch=function(t){if(this.host&&t.match(this.host))return!1;if(!this.configs.path)return!0;if("object"==typeof this.configs.path){for(var e=!1,n=0,r=this.configs.path;n<r.length;n++){var o=r[n];if(t.match(o)){e=!0;break}}return e}return!!t.match(this.configs.path)},e.trackData=function(t){for(var n=0,r=Object.values(e.TRIGGER_MAPS);n<r.length;n++){var o=r[n];o.match(t.url)&&o.triggerFunction(a(a({},t),{url:h(t.url)}))}},e.prototype.setLogicStatus=function(t,e){var n=this.originalDatas[t];if(n&&this.triggerHandler){var r=a(a({},n),{logic_status_code:e});this.triggerHandler(r),delete this.originalDatas[t]}},e.prototype.checkData=function(){Object.keys(this.originalDatas).length>30&&(console.warn("Check if you forgot to call apiPlugin.setLogicStatus() with useLogicStatus is true."),this.originalDatas={})},e.prototype.register=function(t){var n=this;this.triggerHandler=t.trigger,this.host=u.host[t.env];e.TRIGGER_MAPS[t.app_name]={match:this.isMatch.bind(this),triggerFunction:function(e){n.checkData();var r=e.dataId,o=e.type,i=s(e,["dataId","type"]);!n.configs.useLogicStatus||"xhr"===o&&0===i.http_status_code?t.trigger(i):n.originalDatas[r]=i}},this.init()},e.prototype.unregister=function(t){delete e.TRIGGER_MAPS[t],this.triggerHandler=function(){}},e.prototype.init=function(){try{if(this.handleLoadedResource(),this.observe(),e.filled)return;this.trackXHR(),this.trackFetch(),e.filled=!0}catch(t){console.log("Failed to init mdap api plugin"),console.error(t)}},e.prototype.trackXHR=function(){var t=XMLHttpRequest.prototype.send,n=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(){for(var t=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return this.addEventListener("readystatechange",(function(){var n;if(t.readyState===XMLHttpRequest.DONE){var o=+new Date,i=null===(n=t._MDAP_DATA_)||void 0===n?void 0:n.startTimestamp;t._MDAP_DATA_ID_=o.toString(),e.trackData({start_timestamp:i,end_timestamp:o,url:r[1],page_url:""+window.location.origin+window.location.pathname,duration:o-i,http_method:r[0],http_status_code:t.status,logic_status_code:0,dataId:o.toString(),type:"xhr"})}})),n.apply(this,r)},XMLHttpRequest.prototype.send=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._MDAP_DATA_={startTimestamp:+new Date},t.apply(this,e)}},e.prototype.trackFetch=function(){if("function"==typeof window.fetch){var t=window.fetch;window.fetch=function(n,r){var o=+new Date,i=function(t){var i,a=+new Date;t&&(t._MDAP_DATA_ID_=a.toString()),e.trackData({start_timestamp:o,end_timestamp:a,duration:a-o,url:n,page_url:""+window.location.origin+window.location.pathname,http_method:(null==r?void 0:r.method)||"GET",http_status_code:null!==(i=null==t?void 0:t.status)&&void 0!==i?i:0,http_referer:null==r?void 0:r.referrer,logic_status_code:0,dataId:a.toString(),type:"fetch"})};return t.call(window,n,r).then((function(t){return i(t),t}),(function(t){return i(void 0),Promise.reject(t)}))}}},e.prototype.handleTiming=function(t){if(function(t){return"resource"===t.entryType&&["xmlhttprequest","fetch"].includes(t.initiatorType)}(t)&&this.isMatch(t.name)&&this.triggerHandler&&function(t){for(var e=0,n=p;e<n.length;e++){if(!t[n[e]])return!1}return!0}(t)){var e=performance.timeOrigin||performance.timing.navigationStart;this.triggerHandler({url:h(t.name),page_url:""+window.location.origin+window.location.pathname,event_timestamp:Math.round(e),start_time:Math.round(t.startTime),duration:Math.round(t.duration),connect_start:Math.round(t.connectStart),connect_end:Math.round(t.connectEnd),domain_lookup_start:Math.round(t.domainLookupStart),domain_lookup_end:Math.round(t.domainLookupEnd),redirect_start:Math.round(t.redirectStart),redirect_end:Math.round(t.redirectEnd),request_start:Math.round(t.requestStart),response_start:Math.round(t.responseStart),response_end:Math.round(t.responseEnd),worker_start:Math.round(t.workerStart),fetch_start:Math.round(t.fetchStart),secure_connection_start:Math.round(t.secureConnectionStart)})}},e.prototype.handleLoadedResource=function(){var t=this;l&&performance.getEntriesByType("resource").map((function(e){t.handleTiming(e)}))},e.prototype.observe=function(){var t=this;(function(t){var e,n;return null===(n=null===(e=window.PerformanceObserver)||void 0===e?void 0:e.supportedEntryTypes)||void 0===n?void 0:n.includes(t)})("resource")&&(this.po=new PerformanceObserver((function(e){return e.getEntries().map(t.handleTiming.bind(t))})),this.po.observe({entryTypes:["resource"]}))},e.prototype.disconnectObserve=function(){var t;null===(t=this.po)||void 0===t||t.disconnect()},e.prototype.sendData=function(t){if("function"==typeof this.triggerHandler)if(t.url)if("number"==typeof t.duration){var e={http_method:"GET",http_status_code:200,logic_status_code:0,end_timestamp:+new Date,start_timestamp:+new Date-t.duration};this.triggerHandler(a(a({},e),t))}else c.Logger.info("[MDAP] duration should be a number");else c.Logger.info("[MDAP] URL cannot be empty");else c.Logger.info("[MDAP] API Plugin is inactive")},e.TRIGGER_MAPS={},e.filled=!1,e}(u.BasePlugin);e.default=f},"x/NT":function(t,e,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=this&&this.__rest||function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},s=this&&this.__spreadArray||function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Reporter=void 0;var c=n("69Pc"),l=n("UQ8Y"),p=n("nxCq"),h=n("mywx"),f=u(n("pbvT")),d=u(n("IbGn")),g=n("Oe/c"),v=["api","resource","customized"],y=["navigation"],_=["custom_accum"],m=function(t,e){return y.includes(t)},b=function(t,e){return"api"===t&&!!e.event_timestamp},w=function(t,e){return"custom_accum"===t},O=function(){return window.__MDAP_SESSION_ID__=window.__MDAP_SESSION_ID__||h.uuidv4(),window.__MDAP_SESSION_ID__},k=function(){function t(t,e){this.queue=[],this.customQueue=[],this.fingerprint="",this.buildId="",this.labels={},this.session_id="",this.configs=t,this.userAgent=new c.UserAgent,this.network=e,this.offlineStore=new p.OfflineStore(t.app_name,e),this.offlineStore.setup(),this.session_id=O()}return t.prototype.start=function(){var t,e=this;this.buildId=function(){try{return"257a5a14-9c0d-49d8-84fa-471ba2fbdd6d"}catch(t){return""}}(),this.timer=setInterval((function(){e.check()}),null!==(t=this.configs.interval)&&void 0!==t?t:5e3);var n="onpagehide"in self?"pagehide":"unload";window.addEventListener(n,this.check.bind(this,!0),!1)},t.prototype.initFingerprint=function(){return o(this,void 0,void 0,(function(){var t;return i(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,f.default.load()];case 1:return[4,e.sent().get()];case 2:return t=e.sent(),this.fingerprint=t.visitorId,[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}}))}))},t.prototype.addTrackData=function(t){var e=this;return function(n){g.Logger.log("[MDAP report data] "+t+" - ",n),!function(t,e){return _.includes(t.type||e)}(n,t)?e.queue.push({type:t,data:n}):e.customQueue.push({type:n.type,data:n})}},t.prototype.addLabels=function(t){try{this.labels=r(r({},this.labels),t)}catch(t){g.Logger.info("[MDAP] Failed to add new labels")}},t.prototype.register=function(t){try{t.addLabels=this.addLabels.bind(this),t.register({trigger:this.addTrackData(t.type),app_name:this.configs.app_name,env:this.configs.environment}),t.delegateReporter&&(t.reporter=this)}catch(t){g.Logger.log("Failed to register plugin"),g.Logger.error(t)}},t.prototype.unregister=function(t){t.unregister(this.configs.app_name)},t.prototype.check=function(t){return void 0===t&&(t=!1),o(this,void 0,void 0,(function(){var e,n;return i(this,(function(r){switch(r.label){case 0:return this.fingerprint?[3,2]:[4,this.initFingerprint()];case 1:r.sent(),r.label=2;case 2:if(this.queue.length)try{e=this.processData(s([],this.queue)),this.queue=[],this.sendData(e,t)}catch(t){}if(this.customQueue.length)try{n=this.processCustomData(s([],this.customQueue)),this.customQueue=[],this.sendData(n,t)}catch(t){}return[2]}}))}))},Object.defineProperty(t.prototype,"commonData",{get:function(){var t=this.configs,e=t.app_name,n=t.app_version,o=void 0===n?"unknown":n,i=t.app_build_id,a=void 0===i?this.buildId||o||"unknown":i,s=t.user_id,u=void 0===s?"":s;return r(r({event_timestamp:+new Date,app_name:e,app_version:o,app_build_id:a,user_id:u,sdk_name:d.default.name,sdk_version:d.default.version,session_id:this.session_id,tag:"web-performance"},this.userAgent.device),{device_id:this.fingerprint,labels:r(r({},this.userAgent.browserCompatibility),this.labels)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"webCommonData",{get:function(){var t;return r(r({},this.userAgent.webData),{region:null!==(t=this.configs.region)&&void 0!==t?t:"all",environment:this.configs.environment})},enumerable:!1,configurable:!0}),t.prototype.updateConfig=function(t){this.configs=Object.assign(this.configs,t)},t.prototype.processData=function(t){for(var e,n,o=[],i=[],s=r(r({},this.commonData),{data:this.webCommonData}),u=0,c=t;u<c.length;u++){var l=c[u];if(b(l.type,l.data)){var p=l.data,h=p.event_timestamp,f=a(p,["event_timestamp"]);s.event_timestamp=h,i.push(f)}else if(n=l.type,l.data,v.includes(n))l.data.type=l.type,o.push(l.data);else if(m(l.type,l.data)){var d=l.data;h=d.event_timestamp,f=a(d,["event_timestamp"]);s.data.page_performance=f,s.data.page_performance.offline_bundle=null!==(e=this.configs.offline_bundle)&&void 0!==e&&e,s.event_timestamp=h}}return o.length&&(s.data.entries=o),i.length&&(s.data.api_performances=i),s},t.prototype.processCustomData=function(t){for(var e=r(r({},this.commonData),{tag:"web-custom",data:this.webCommonData}),n=[],o=0,i=t;o<i.length;o++){var s=i[o];if(w(s.type,s.data)){var u=s.data,c=(u.type,a(u,["type"]));n.push(c)}}return e.data.custom_accums=n,e},t.prototype.sendData=function(t,e){return void 0===e&&(e=!1),o(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.network.sendRequest({reportData:t,pageUnload:e})];case 1:return(n=r.sent())===l.REQUEST_FAILED&&this.offlineStore.cacheData(t),"function"==typeof this.onDataSentCallback&&this.onDataSentCallback(n),[3,3];case 2:return r.sent(),this.offlineStore.cacheData(t),[3,3];case 3:return[2]}}))}))},t.prototype.sendBulkData=function(t){return o(this,void 0,void 0,(function(){var e;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.network.sendBulk({tag:"web-exception",data:t})];case 1:return(null==(e=n.sent())?void 0:e.errors)&&this.offlineStore.cacheData(t),"function"==typeof this.onDataSentCallback&&this.onDataSentCallback(e),[2,e];case 2:return n.sent(),this.offlineStore.cacheData(t),[3,3];case 3:return[2]}}))}))},t.prototype.onDataSent=function(t){this.onDataSentCallback=t},t.prototype.close=function(){this.timer&&clearInterval(this.timer),this.check()},t}();e.Reporter=k}}]);